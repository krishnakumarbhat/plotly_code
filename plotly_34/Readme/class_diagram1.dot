digraph G {
    rankdir=TB;
    node [shape=record, fontname="Arial", fontsize=10];
    edge [fontname="Arial", fontsize=8];
    
    // Configuration Layer
    subgraph cluster_config {
        label="Configuration Layer";
        style=filled;
        color=lightgrey;
        
        XmlConfigParser [label="{XmlConfigParser|+ xml_file\l+ hdf_source_selection\l+ hdf_file_type\l+ plot_mode\l|+ parse()\l+ get_hdf_file_type()\l+ get_hdf_source_selection()\l+ get_plot_mode()\l}"];
        
        JSONParserFactory [label="{JSONParserFactory||+ create_parser(hdf_file_type, json_file, per_sensor_json_file)\l}"];
        
        AllsensorJSONParser [label="{AllsensorJSONParser|+ json_file\l+ io_map\l|+ parse()\l+ get_io_map()\l}"];
        
        PersensorJSONParser [label="{PersensorJSONParser|+ json_file\l+ io_map\l|+ parse()\l+ get_io_map()\l}"];
    }
    
    // Database Layer
    subgraph cluster_db {
        label="Database Layer";
        style=filled;
        color=lightblue;
        
        HdfProcessorFactory [label="{HdfProcessorFactory|+ file_dict\l+ hdf_file_type\l|+ process()\l}"];
        
        AllsensorHdfParser [label="{AllsensorHdfParser|+ address_map\l+ data_container\l+ data_container_out\l+ unique_map\l+ unique_map_out\l|+ parse()\l- _get_data_mapper()\l- _process_data()\l}"];
        
        PersensorHdfParser [label="{PersensorHdfParser|+ address_map\l+ data_container\l+ data_container_out\l+ unique_map\l+ unique_map_out\l|+ parse()\l- _get_data_mapper()\l- _process_data()\l}"];
    }
    
    // Business Layer
    subgraph cluster_business {
        label="Business Layer";
        style=filled;
        color=lightgreen;
        
        DataContainer [label="{DataContainer|+ data_container\l+ unique_map\l+ data_container_out\l+ unique_map_out\l+ html_name\l|+ __init__()\l}"];
        
        DataPrep [label="{DataPrep|+ data_container\l+ unique_map\l+ data_container_out\l+ unique_map_out\l+ html_name\l+ parent_tabs\l+ plots_hash\l|+ create_parent_tabs()\l+ generate_html_content()\l}"];
    }
    
    // Presentation Layer
    subgraph cluster_presentation {
        label="Presentation Layer";
        style=filled;
        color=lightyellow;
        
        PlotGenerator [label="{PlotGenerator|+ plots_hash\l+ parent_tabs\l+ html_name\l|+ generate_plots()\l}"];
    }
    
    // Main Class
    MainProcessor [label="{MainProcessor|+ config\l+ logger\l|+ __init__()\l+ _parse_config()\l+ run()\l}"];
    
    // Relationships
    MainProcessor -> XmlConfigParser [arrowhead="vee", label="uses"];
    MainProcessor -> JSONParserFactory [arrowhead="vee", label="uses"];
    MainProcessor -> HdfProcessorFactory [arrowhead="vee", label="uses"];
    
    JSONParserFactory -> AllsensorJSONParser [arrowhead="vee", label="creates"];
    JSONParserFactory -> PersensorJSONParser [arrowhead="vee", label="creates"];
    
    HdfProcessorFactory -> AllsensorHdfParser [arrowhead="vee", label="creates"];
    HdfProcessorFactory -> PersensorHdfParser [arrowhead="vee", label="creates"];
    
    DataContainer -> DataPrep [arrowhead="vee", label="uses"];
    DataPrep -> PlotGenerator [arrowhead="vee", label="uses"];
    
    // Factory Pattern Dependencies
    edge [style=dashed];
    AllsensorJSONParser -> JSONParserFactory [dir=back];
    PersensorJSONParser -> JSONParserFactory [dir=back];
    AllsensorHdfParser -> HdfProcessorFactory [dir=back];
    PersensorHdfParser -> HdfProcessorFactory [dir=back];
}
